<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spjzweb.dao.ContractInfoDao">


    <select id="getCountAllByLike" resultType="int">
        select count(*) from contract_info r
        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no LIKE CONCAT('%',#{contract_no},'%')
            </if>
        </where>
    </select>

    <select id="getAllByLike" resultType="map">
        select * from  contract_info r

        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no LIKE CONCAT('%',#{contract_no},'%')
            </if>
        </where>
        ORDER BY id DESC
        limit #{skip},#{take}
    </select>


    <select id="getContractInfoByContractNoOfAdd" resultType="com.spjzweb.entity.ContractInfo">
        select * from  contract_info r
        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no =#{contract_no}
            </if>
        </where>
    </select>
    <select id="getContractInfoByContractNoOfEdit" resultType="com.spjzweb.entity.ContractInfo">
        select * from  contract_info r
        <where>
            <if test="contract_no!=null and contract_no!=''">
                #{contract_no}  IN (SELECT contract_no FROM contract_info where contract_no!=#{contract_no})
            </if>
        </where>
    </select>
    <insert id="addContractInfo" parameterType="com.spjzweb.entity.ContractInfo">
      INSERT INTO contract_info(contract_no,machining_contract_no,od,wt,pipe_heat_no,pipe_lot_no,pipe_steel_grade,pipe_meterial,graph_no,handbook_no,seal_sample_graph_no,thread_sample_graph_no,thread_acceptance_criteria_no,remark) VALUES (#{contract_no},#{machining_contract_no},#{od},#{wt},#{pipe_heat_no},#{pipe_lot_no},#{pipe_steel_grade},#{pipe_meterial},#{graph_no},#{handbook_no},#{seal_sample_graph_no},#{thread_sample_graph_no},#{thread_acceptance_criteria_no},#{remark})
    </insert>

    <update id="updateContractInfo" parameterType="com.spjzweb.entity.ContractInfo">
      UPDATE contract_info set contract_no=#{contract_no},machining_contract_no=#{machining_contract_no},od=#{od},wt=#{wt},pipe_heat_no=#{pipe_heat_no},pipe_lot_no=#{pipe_lot_no},pipe_steel_grade=#{pipe_steel_grade},pipe_meterial=#{pipe_meterial},graph_no=#{graph_no},handbook_no=#{handbook_no},seal_sample_graph_no=#{seal_sample_graph_no},thread_sample_graph_no=#{thread_sample_graph_no},thread_acceptance_criteria_no=#{thread_acceptance_criteria_no},remark=#{remark} where id=#{id}
    </update>


    <delete id="delContractInfo">
        delete from contract_info WHERE
        <foreach collection="array" item="item" open="id in (" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>