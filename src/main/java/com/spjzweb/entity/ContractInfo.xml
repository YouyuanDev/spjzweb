<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spjzweb.dao.ContractInfoDao">


    <select id="getCountAllByLike" resultType="int">
        select count(*) from contract_info r
        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no LIKE CONCAT('%',#{contract_no},'%')
            </if>
        </where>
    </select>

    <select id="getAllByLike" resultType="map">
        select * from  contract_info r

        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no LIKE CONCAT('%',#{contract_no},'%')
            </if>
        </where>
        ORDER BY id DESC
        limit #{skip},#{take}
    </select>


    <select id="getContractInfoByContractNo" resultType="com.spjzweb.entity.ContractInfo">
        select * from  contract_info r
        <where>
            <if test="contract_no!=null and contract_no!=''">
                AND r.contract_no =#{contract_no}
            </if>
        </where>
    </select>



    <insert id="addContractInfo" parameterType="com.spjzweb.entity.ContractInfo">
        INSERT INTO contract_info(contract_no,machining_contract_no,od,wt,pipe_heat_no,pipe_lot_no,pipe_steel_grade,pipe_meterial,graph_no,handbook_no,seal_sample_graph_no,thread_sample_graph_no,thread_acceptance_criteria_no,remark) VALUES (#{measure_item_code},#{measure_item_name},#{measure_item_name_en},#{measure_tool1},#{measure_tool2},#{measure_sample1},#{measure_sample2},#{measure_unit},#{item_frequency})
    </insert>

    <update id="updateContractInfo" parameterType="com.spjzweb.entity.ContractInfo">
        UPDATE contract_info set #{contract_no},#{machining_contract_no},#{od},#{wt},#{pipe_heat_no},#{pipe_lot_no},#{pipe_steel_grade},#{pipe_meterial},#{graph_no},#{handbook_no},#{seal_sample_graph_no},#{thread_sample_graph_no},#{thread_acceptance_criteria_no},#{remark} where id=#{id}
    </update>


    <delete id="delContractInfo">
        delete from contract_info WHERE
        <foreach collection="array" item="item" open="id in (" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>